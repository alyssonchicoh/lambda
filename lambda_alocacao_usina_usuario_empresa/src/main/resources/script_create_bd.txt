CREATE TABLE #SCHEMA#.PERMISSAO(
	ID SERIAL PRIMARY KEY,
	nome VARCHAR(255),
	descricao VARCHAR(500)
);

CREATE TABLE #SCHEMA#.GRUPO(
	id SERIAL PRIMARY KEY,
	nome VARCHAR(255),
	descricao VARCHAR(500)
);

CREATE TABLE #SCHEMA#.GRUPO_PERMISSAO(
	ID SERIAL PRIMARY KEY,
	ID_GRUPO INT REFERENCES #SCHEMA#.GRUPO (ID),
	ID_PERMISSAO INT REFERENCES #SCHEMA#.PERMISSAO (ID)
);

CREATE TABLE #SCHEMA#.USUARIO(
	ID SERIAL PRIMARY KEY,
	NOME VARCHAR(255) NOT NULL,
	CPF VARCHAR(255) UNIQUE,
	ID_GRUPO INT REFERENCES #SCHEMA#.GRUPO (ID)
);

CREATE TABLE #SCHEMA#.ESTADO(
	ID SERIAL PRIMARY KEY,
	NOME VARCHAR(255) NOT NULL,
	UF VARCHAR(2) NOT NULL
);

CREATE TABLE #SCHEMA#.CIDADE(
	ID SERIAL PRIMARY KEY,
	NOME VARCHAR (255) NOT NULL,
	ID_ESTADO INT REFERENCES #SCHEMA#.ESTADO (ID)
);

CREATE TABLE #SCHEMA#.HOSPITAL(
	ID SERIAL PRIMARY KEY,
	NOME VARCHAR(255) NOT NULL,
	ENDERECO VARCHAR (500),
	ID_CIDADE INT REFERENCES #SCHEMA#.CIDADE (ID),
	NOME_RESPONSAVEL VARCHAR(255),
	TELEFONE_RESPONSAVEL VARCHAR(255)
);

CREATE TABLE #SCHEMA#.USINA(
	ID SERIAL PRIMARY KEY,
	NOME VARCHAR(255) NOT NULL,
	NUMERO_SERIE VARCHAR(255),
	FABRICANTE VARCHAR(255),
	DATA_CONSTRUCAO DATE,
	DATA_COMPRA DATE,
	ID_HOSPITAL INT REFERENCES #SCHEMA#.HOSPITAL (ID)
);

 CREATE TYPE #SCHEMA#.NOME_PARAMETRO_ENUM AS ENUM(
	 'PUREZA',
	 'FLUXO',
	 'PRESSAO_ENTRADA',
	 'PRESSAO_SAIDA',
	 'PRESSAO_ORVALHO',
	 'TEMPERATURA'
 );
 
CREATE TYPE #SCHEMA#.UNIDADE_MEDIDA_ENUM AS ENUM(
	 'M/S',
	 'M/H',
	 'C'
 );


CREATE TABLE #SCHEMA#.INFO_PARAMETRO(
	ID SERIAL PRIMARY KEY,
	NOME #SCHEMA#.NOME_PARAMETRO_ENUM DEFAULT NULL,
	UNIDADE_MEDIDA #SCHEMA#.UNIDADE_MEDIDA_ENUM DEFAULT NULL,
	LIMIAR_SUPERIOR REAL NOT NULL,
	LIMIAR_INFERIOR REAL NOT NULL,
	PORCENTAGEM_APROXIMACAO_LIMIAR_SUPERIOR REAL NOT NULL,
	PORCENTAGEM_APROXIMACAO_LIMIAR_INFERIOR REAL NOT NULL,
	ID_USINA INT REFERENCES #SCHEMA#.USINA (ID)
);

CREATE TYPE #SCHEMA#.TIPO_ALARME AS ENUM (
 	'EXCECAO',
	'APROXIMACAO'
);

CREATE TABLE #SCHEMA#.ALARME(
	ID SERIAL PRIMARY KEY,
	DATA TIMESTAMP NOT NULL,
	NOME #SCHEMA#.NOME_PARAMETRO_ENUM DEFAULT NULL,
	UNIDADE_MEDIDA #SCHEMA#.UNIDADE_MEDIDA_ENUM DEFAULT NULL,
	TIPO #SCHEMA#.TIPO_ALARME DEFAULT NULL,
	LIMIAR_SUPERIOR REAL NOT NULL,
	LIMIAR_INFERIOR REAL NOT NULL,
	ID_LEITURA_BANCO_NAO_RELACIONAL INT NOT NULL
);

CREATE TABLE #SCHEMA#.ALARME_LIDO(
	ID SERIAL PRIMARY KEY,
	DATA TIMESTAMP NOT NULL,
	ID_USUARIO INT REFERENCES #SCHEMA#.USUARIO (ID),
	ID_ALARME INT REFERENCES #SCHEMA#.ALARME (ID)
);

CREATE TABLE #SCHEMA#.USUARIO_USINA (
	ID SERIAL PRIMARY KEY,
	ID_USUARIO INT REFERENCES #SCHEMA#.USUARIO (ID),
	ID_USINA INT REFERENCES #SCHEMA#.USINA (ID)
);